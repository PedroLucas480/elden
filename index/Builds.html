<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elden Builds - Builds</title>
    
    <script>
        if (!localStorage.getItem('token')) {
            window.location.href = "login.html";
        }
    </script>

    <link rel="stylesheet" href="/css/Builds.css">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <main>
        <div class="infromaçaoadireita">
            <header class="top-menu">
                <nav>
                    <a href="index.html">Home</a>
                    <a href="Builds.html" class="active">Builds</a>
                    <a href="#">About us</a>
                    <a href="#">Help</a>
                </nav>
            </header>

            <section class="container-builds">
                </section>
        </div>

        <script>
            async function carregarBuilds() {
                try {
                    const response = await fetch('http://localhost:3000/api/builds');
                    const builds = await response.json();
                    const container = document.querySelector('.container-builds');
                    container.innerHTML = '';

                    builds.forEach(build => {
                        // Lógica para definir a cor da dificuldade
                        let corDificuldade = "#fff"; 
                        if (build.dificuldade === 'Fácil') corDificuldade = "#2ecc71"; 
                        if (build.dificuldade === 'Média') corDificuldade = "#f1c40f"; 
                        if (build.dificuldade === 'Alta') corDificuldade = "#e74c3c";  

                        container.innerHTML += `
                            <a href="detalhes.html?id=${build.id}" style="text-decoration: none; color: inherit;">
                                <div class="build-card">
                                    <div class="build-img">
                                        <img src="../${build.imagem_url}" alt="${build.nome}">
                                    </div>
                                    <div class="build-txt">
                                        <h3>${build.nome}</h3>
                                        <p>${build.descricao}</p>
                                        <span class="status" style="color: ${corDificuldade}; font-weight: bold;">
                                            Dificuldade: ${build.dificuldade}
                                        </span>
                                    </div>
                                </div>
                            </a>
                        `;
                    });
                } catch (error) {
                    console.error('Erro ao carregar builds:', error);
                }
            }
            
            // Só chama a função se houver token (evita erro de fetch desnecessário)
            if (localStorage.getItem('token')) {
                carregarBuilds();
            }
        </script>
    </main>
</body>
</html>