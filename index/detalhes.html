<script>
    async function carregarDetalhes() {
        // 1. Pega os parâmetros da URL
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        
        // Busca o elemento na tela
        const container = document.getElementById('build-info');

        // Se o elemento build-info não existir no seu HTML, o código para aqui e te avisa
        if (!container) {
            console.error("ERRO: O elemento <div id='build-info'> não foi encontrado no seu HTML.");
            return;
        }

        if (!id) {
            container.innerHTML = "<h2>ID da build não fornecido.</h2>";
            return;
        }

        try {
            const URL_RAILWAY = "https://elden-production.up.railway.app"; 

            const apiBaseUrl = window.location.hostname === 'localhost' 
                ? 'http://localhost:3000' 
                : URL_RAILWAY;

            const response = await fetch(`${apiBaseUrl}/api/builds/${id}`);
            
            if (!response.ok) throw new Error('Build não encontrada no servidor');
            
            const build = await response.json();

            // Preenche o conteúdo
            container.innerHTML = `
                <h1>${build.nome}</h1>
                <p style="color: #ccc; font-style: italic;">${build.descricao || 'Sem descrição'}</p>
                
                <h3 style="margin-top:30px;">ESTATUTOS (STATS)</h3>
                <div class="grid-stats">
                    <div class="stat-item">VIGOR: ${build.vigor || 0}</div>
                    <div class="stat-item">MENTE: ${build.mente || 0}</div>
                    <div class="stat-item">RESISTÊNCIA: ${build.resistencia || 0}</div>
                    <div class="stat-item">FORÇA: ${build.forca || 0}</div>
                    <div class="stat-item">DESTREZA: ${build.destreza || 0}</div>
                    <div class="stat-item">INTELIGÊNCIA: ${build.inteligencia || 0}</div>
                    <div class="stat-item">FÉ: ${build.fe || 0}</div>
                    <div class="stat-item">ARCANO: ${build.arcano || 0}</div>
                </div>

                <div class="equipamentos">
                    <h3>EQUIPAMENTOS E LOCALIZAÇÃO</h3>
                    <p><strong>Arma Principal:</strong> ${build.arma_principal || 'Não informada'}</p>
                    <p><strong>Classe Inicial Sugerida:</strong> ${build.classe_inicial || 'Qualquer uma'}</p>
                    <p><strong>Onde encontrar:</strong> ${build.localizacao_nome || 'Explorando o mapa'}</p>
                    ${build.localizacao_url ? `<a href="${build.localizacao_url}" target="_blank" style="color: #d6b36a; font-weight: bold;">[Ver no Mapa Interativo]</a>` : ''}
                </div>
                
                <br><br>
                <a href="Builds.html" style="color: #fff; text-decoration: none; border: 1px solid #fff; padding: 5px 15px;">← Voltar para lista</a>
            `;
        } catch (error) {
            console.error("Erro ao carregar detalhes:", error);
            container.innerHTML = `<h2>Erro: ${error.message}</h2>`;
        }
    }

    // ISSO GARANTE QUE O CÓDIGO SÓ RODA DEPOIS QUE A PÁGINA CARREGAR
    window.addEventListener('DOMContentLoaded', carregarDetalhes);
</script>