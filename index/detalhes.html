<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes da Build - Elden Builds</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/detalhes.css">
</head>
<body>

    <main>
        <div id="build-info">
            <h2 style="color: rgb(255, 255, 255); text-align: center;">Carregando detalhes da build...</h2>
        </div>
    </main>

    <script>
        async function carregarDetalhes() {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');
            const container = document.getElementById('build-info');

            if (!container) return;
            if (!id) {
                container.innerHTML = "<h2>Build não identificada.</h2>";
                return;
            }

            try {
                const URL_RAILWAY = "https://elden-production.up.railway.app"; 
                const apiBaseUrl = window.location.hostname === 'localhost' 
                    ? 'http://localhost:3000' 
                    : URL_RAILWAY;

                const response = await fetch(`${apiBaseUrl}/api/builds/${id}`);
                if (!response.ok) throw new Error('Build não encontrada');
                
                const build = await response.json();

                // Monta o visual original que você definiu
                container.innerHTML = `
                    <h1>${build.nome}</h1>
                    <p style="color: #ccc; font-style: italic;">${build.descricao || 'Sem descrição'}</p>
                    
                    <h3 style="margin-top:30px;">ESTATUTOS (STATS)</h3>
                    <div class="grid-stats" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div class="stat-item">VIGOR: ${build.vigor || 0}</div>
                        <div class="stat-item">MENTE: ${build.mente || 0}</div>
                        <div class="stat-item">RESISTÊNCIA: ${build.resistencia || 0}</div>
                        <div class="stat-item">FORÇA: ${build.forca || 0}</div>
                        <div class="stat-item">DESTREZA: ${build.destreza || 0}</div>
                        <div class="stat-item">INTELIGÊNCIA: ${build.inteligencia || 0}</div>
                        <div class="stat-item">FÉ: ${build.fe || 0}</div>
                        <div class="stat-item">ARCANO: ${build.arcano || 0}</div>
                    </div>

                    <div class="equipamentos" style="margin-top: 20px; border-top: 1px solid #444; padding-top: 20px;">
                        <h3>EQUIPAMENTOS E LOCALIZAÇÃO</h3>
                        <p><strong>Arma Principal:</strong> ${build.arma_principal || 'Não informada'}</p>
                        <p><strong>Classe Inicial Sugerida:</strong> ${build.classe_inicial || 'Qualquer uma'}</p>
                        <p><strong>Onde encontrar:</strong> ${build.localizacao_nome || 'Explorando o mapa'}</p>
                        ${build.localizacao_url ? `<a href="${build.localizacao_url}" target="_blank" style="color: #d6b36a; font-weight: bold;">[Ver no Mapa Interativo]</a>` : ''}
                    </div>
                    
                    <br><br>
                    <a href="Builds.html" style="color: #fff; text-decoration: none; border: 1px solid #fff; padding: 5px 15px;">← Voltar para lista</a>
                `;
            } catch (error) {
                container.innerHTML = `<h2 style="color: #e74c3c;">Erro: ${error.message}</h2>
                <a href="Builds.html" style="color: #fff;">Voltar</a>`;
            }
        }

        window.addEventListener('DOMContentLoaded', carregarDetalhes);
    </script>
</body>
</html>