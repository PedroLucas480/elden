<script>
    async function carregarDetalhes() {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');

        if(!id) return;

        try {
            // "window.location.origin" detecta automaticamente se o site está no Railway ou no PC
            const apiBaseUrl = window.location.hostname === 'localhost' 
                ? 'http://localhost:3000' 
                : window.location.origin;

            const response = await fetch(`${apiBaseUrl}/api/builds/${id}`);
            
            if (!response.ok) throw new Error('Build não encontrada');
            
            const build = await response.json();

            document.getElementById('build-info').innerHTML = `
                <h1>${build.nome}</h1>
                <p style="color: #ccc; font-style: italic;">${build.descricao || 'Sem descrição'}</p>
                
                <h3 style="margin-top:30px;">ESTATUTOS (STATS)</h3>
                <div class="grid-stats">
                    <div class="stat-item">VIGOR: ${build.vigor || 0}</div>
                    <div class="stat-item">MENTE: ${build.mente || 0}</div>
                    <div class="stat-item">RESISTÊNCIA: ${build.resistencia || 0}</div>
                    <div class="stat-item">FORÇA: ${build.forca || 0}</div>
                    <div class="stat-item">DESTREZA: ${build.destreza || 0}</div>
                    <div class="stat-item">INTELIGÊNCIA: ${build.inteligencia || 0}</div>
                    <div class="stat-item">FÉ: ${build.fe || 0}</div>
                    <div class="stat-item">ARCANO: ${build.arcano || 0}</div>
                </div>

                <div class="equipamentos">
                    <h3>EQUIPAMENTOS E LOCALIZAÇÃO</h3>
                    <p><strong>Arma Principal:</strong> ${build.arma_principal || 'Não informada'}</p>
                    <p><strong>Classe Inicial Sugerida:</strong> ${build.classe_inicial || 'Qualquer uma'}</p>
                    <p><strong>Onde encontrar:</strong> ${build.localizacao_nome || 'Explorando o mapa'}</p>
                    ${build.localizacao_url ? `<a href="${build.localizacao_url}" target="_blank" style="color: #d6b36a; font-weight: bold;">[Ver no Mapa Interativo]</a>` : ''}
                </div>
                
                <br><br>
                <a href="Builds.html" style="color: #fff; text-decoration: none; border: 1px solid #fff; padding: 5px 15px;">← Voltar para lista</a>
            `;
        } catch (error) {
            console.error("Erro ao carregar detalhes:", error);
            document.getElementById('build-info').innerHTML = "<h2>Erro ao carregar dados. Verifique se as builds foram inseridas no banco.</h2>";
        }
    }
    carregarDetalhes();
</script>